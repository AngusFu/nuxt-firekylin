(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{247:function(v,_,l){"use strict";l.r(_);var e={computed:{data:function(){return{title:"笔记：velocity 2016 第一天",description:"velocity 2016 笔记",keywords:"原创,笔记",pathname:"velocity-2016-note-1",translation:null,create_time:"2016-12-01",prev:{title:"笔记：velocity 2016 第二天",pathname:"velocity-2016-day-2"},next:{title:"[译] CSS 方法论的选择",pathname:"when-to-use-which-css-methodology"}}}}},t=l(3),component=Object(t.a)(e,function(){var v=this,_=v.$createElement,l=v._self._c||_;return l("post",{attrs:{data:v.data}},[l("p",[v._v("有幸得到老大给的 Velocity 大会门票，屁颠屁颠跑去听分享。下面是今天（第一天）的笔记。记得比较简略，凑合看吧。"),l("a",{attrs:{href:"http://velocity.oreilly.com.cn/2016/index.php?func=slidesvideos",target:"_blank"}},[v._v("PPT 下载通道")]),v._v("已经放出来了，感兴趣的可以自己跟踪一下。")]),v._v(" "),l("h2",{attrs:{id:"usetheplatform-web-"}},[v._v("UseThePlatform —— Web 组件介绍")]),v._v(" "),l("blockquote",[l("p",[v._v("分析者：来自 Youtube 的 Mikhail Sychev")]),v._v(" "),l("p",[v._v("感觉就是对 Polymer 和 Web Components 的科普。期待明天更详细的分享。")]),v._v(" "),l("p",[v._v("其实关于 Polymer，打开 Chrome 的 "),l("code",[v._v("chrome://downloads/")]),v._v(" 查看源码，就能学到不少东西：CSS 变量、Shadow DOM、Polymer 等等。之前打算就这个写篇博客，一直没动手。")])]),v._v(" "),l("p",[v._v("(略….)")]),v._v(" "),l("hr"),v._v(" "),l("h2",{attrs:{id:"-"}},[v._v("搜索引擎性能优化的未来 —— 搜索极速浏览框架")]),v._v(" "),l("blockquote",[l("p",[v._v("分享者：来自百度的陶清乾")]),v._v(" "),l("p",[v._v("听到最后才发现，原来是搞了套自己的后端工具，你“打开”的页面，可能只是百度缓存、处理过的。（免责声明：理解可能有偏差）还提了下使用的 工具 MIP。")])]),v._v(" "),l("h3",{attrs:{id:"-"}},[v._v("全流程优化")]),v._v(" "),l("ul",[l("li",[v._v("展现交互")]),v._v(" "),l("li",[v._v("加载策略")]),v._v(" "),l("li",[v._v("页面渲染")])]),v._v(" "),l("h3",{attrs:{id:"-"}},[v._v("框架解决问题")]),v._v(" "),l("ul",[l("li",[v._v("创建容器视图，提升交互体验")]),v._v(" "),l("li",[v._v("异步加载渲染，提升页面渲染速度")]),v._v(" "),l("li",[v._v("prefetch 实例，优化网络、服务开销")]),v._v(" "),l("li",[v._v("优化机制，优化细粒度模块速度")])]),v._v(" "),l("h3",{attrs:{id:"-"}},[v._v("感知交互时间")]),v._v(" "),l("p",[v._v("点击搜索结果 => 页面响应")]),v._v(" "),l("h3",{attrs:{id:"-"}},[v._v("加速原理")]),v._v(" "),l("h4",{attrs:{id:"-"}},[v._v("传统页面")]),v._v(" "),l("p",[v._v("点击。连接。响应。基础渲染。内容渲染。组件加载。")]),v._v(" "),l("h4",{attrs:{id:"-"}},[v._v("加速")]),v._v(" "),l("p",[v._v("点击 ")]),v._v(" "),l("p",[v._v("​    A => 交互响应。基础渲染。。。。")]),v._v(" "),l("p",[v._v("​        B => 连接。响应。 。。。")]),v._v(" "),l("p",[v._v("。。。。内容渲染、组件加载")]),v._v(" "),l("h2",{attrs:{id:"-"}},[v._v("应用性能数据可视化")]),v._v(" "),l("blockquote",[l("p",[v._v("分享者：来自 mmTrix 的朱建锋")]),v._v(" "),l("p",[v._v("先是对可视化、性能等做了一些介绍，之后讲数据处理，科普了几种平均数，之后科普了各种常用的图（如雷达图、南丁格尔玫瑰图 etc.）。")])]),v._v(" "),l("h3",{attrs:{id:"-"}},[v._v("前面")]),v._v(" "),l("ul",[l("li",[v._v("尽量使用抗干扰性更好的方法计算性能数据")]),v._v(" "),l("li",[v._v("标准差衡量性能标准")])]),v._v(" "),l("h3",{attrs:{id:"-"}},[v._v("可视化是一个编码过程")]),v._v(" "),l("ul",[l("li",[v._v("基本的简单的图。")]),v._v(" "),l("li",[v._v("目的：表达数据。")])]),v._v(" "),l("h3",{attrs:{id:"-1s"}},[v._v("请求理想时间小于 1s")]),v._v(" "),l("ul",[l("li",[v._v("DNS: 50ms")]),v._v(" "),l("li",[v._v("TCP shakes: 100ms")]),v._v(" "),l("li",[v._v("SSL(https): 300ms")]),v._v(" "),l("li",[v._v("Waiting for Response: 250ms（网络请求 => First Byte）")]),v._v(" "),l("li",[v._v("接收 Data: 300ms")])]),v._v(" "),l("hr"),v._v(" "),l("h2",{attrs:{id:"hulu-react-redux-"}},[v._v("Hulu 的 React / Redux 构架实践")]),v._v(" "),l("blockquote",[l("p",[v._v("分享者：来自“美国的爱奇艺” Hulu 的程墨")]),v._v(" "),l("p",[v._v("较基础，但对于 Constraints vs Conventions 相关的内容非常不错，很值得思考。")])]),v._v(" "),l("h3",{attrs:{id:"challenges"}},[v._v("Challenges")]),v._v(" "),l("ul",[l("li",[v._v("System Complexity"),l("ul",[l("li",[v._v("Legacy code in jQuery & Backbone")]),v._v(" "),l("li",[v._v("UI non-predictable")]),v._v(" "),l("li",[v._v("Lack of component isolation")])])]),v._v(" "),l("li",[v._v("Performance Bottleneck"),l("ul",[l("li",[v._v("Initial AJAX roundtrip")])])])]),v._v(" "),l("h3",{attrs:{id:"tech-stack"}},[v._v("Tech Stack")]),v._v(" "),l("ul",[l("li",[l("strong",[v._v("Before")]),v._v(": jQuery + Backbone + Ruby on Rails")])]),v._v(" "),l("ul",[l("li",[l("strong",[v._v("After")]),v._v(": React + Redux + Node & Express")])]),v._v(" "),l("h3",{attrs:{id:"other-notes"}},[v._v("Other Notes")]),v._v(" "),l("ul",[l("li",[l("code",[v._v("React APP = Keep Rndering")])]),v._v(" "),l("li",[l("code",[v._v("UI = f(state)")])]),v._v(" "),l("li",[v._v("Constraints vs Conventions")])]),v._v(" "),l("hr"),v._v(" "),l("h2",{attrs:{id:"-react-native-"}},[v._v("数亿级用户规模下的 React Native 应用实践")]),v._v(" "),l("blockquote",[l("p",[v._v("分享者：来自百度的雷志兴")]),v._v(" "),l("p",[v._v("做过一段时间的 RN，所以基本能听懂。")]),v._v(" "),l("p",[v._v("其他的内容，个人感觉可算干货满满。没提到热更新。")]),v._v(" "),l("p",[v._v("结合此前 58 同城 RN、携程 RN 等文章一起看，会更好的哈哈")])]),v._v(" "),l("h3",{attrs:{id:"-"}},[v._v("手机百度")]),v._v(" "),l("ul",[l("li",[v._v("迭代周期： 4周")]),v._v(" "),l("li",[v._v("主要 features：数十个")]),v._v(" "),l("li",[v._v("开发工时：数千人时")]),v._v(" "),l("li",[v._v("跨部门，沟通成本高")]),v._v(" "),l("li",[v._v("业务种类多，集成成本高")]),v._v(" "),l("li",[v._v("过去的解耦方案"),l("ul",[l("li",[v._v("APK 插件 / SDK")]),v._v(" "),l("li",[v._v("Hybrid")])])]),v._v(" "),l("li",[v._v("迭代速度：native 的 5-8 倍")])]),v._v(" "),l("h3",{attrs:{id:"rn-"}},[v._v("RN 工程实践")]),v._v(" "),l("ul",[l("li",[v._v("与现有业务融合"),l("ul",[l("li",[v._v("Android 4.1 以上")]),v._v(" "),l("li",[v._v("v0.32 以上不支持 iOS 7")]),v._v(" "),l("li",[l("strong",[v._v("降级兼容")]),v._v("：随时回撤；AB Test")]),v._v(" "),l("li",[l("strong",[v._v("性能方面")]),v._v(": 空间换时间，便利性换性能；减少重绘，减少通讯")]),v._v(" "),l("li",[v._v("统一交互协议：RN 和 Native 相互之间的调用")])])]),v._v(" "),l("li",[v._v("融入迭代流程"),l("ul",[l("li",[v._v("首先，前提是业务方明确提出 RN 产品需求，明确哪些能够做到")]),v._v(" "),l("li",[v._v("容灾方案：报错率较高怎么办？")]),v._v(" "),l("li",[v._v("开发")]),v._v(" "),l("li",[v._v("发布：打包、测试后由 PM 从平台发布")]),v._v(" "),l("li",[l("strong",[v._v("监控")]),v._v("：一定要能够监控到 RN 层，尤其是 js 层的报错信息（Note：坑！！！！！！！！）")])])]),v._v(" "),l("li",[v._v("性能优化"),l("ul",[l("li",[v._v("通讯频繁 by design： js 足够的灵活性")]),v._v(" "),l("li",[v._v("易导致卡顿"),l("ul",[l("li",[v._v("事件频率高")]),v._v(" "),l("li",[v._v("js 运行时间长")]),v._v(" "),l("li",[v._v("UI 绘制频繁")])])]),v._v(" "),l("li",[v._v("初始化成本高"),l("ul",[l("li",[v._v("生成模块配置表")])])]),v._v(" "),l("li",[v._v("ListView 优化"),l("ul",[l("li",[v._v("View 无法复用，内存紧张")]),v._v(" "),l("li",[v._v("DOM diff： 大量重新渲染")]),v._v(" "),l("li",[v._v("业务层优化：预留空白单元；大量内容时重新渲染")]),v._v(" "),l("li",[l("strong",[v._v("解决 1")]),v._v("：删除非可视区 View")]),v._v(" "),l("li",[l("strong",[v._v("解决 2")]),v._v("：模板复用（item 可能跳动、闪烁）")]),v._v(" "),l("li",[v._v("建议：产品进行限制，超过一定数量时重新刷新")])])]),v._v(" "),l("li",[v._v("动画"),l("ul",[l("li",[v._v("16ms，容易丢帧")]),v._v(" "),l("li",[v._v("实验特性 userNativeDriver: true —— 将动画数据算好全部发给 Native，减少通讯")])])]),v._v(" "),l("li",[v._v("启动速度优化"),l("ul",[l("li",[v._v("预初始化：APP 启动后，立即 instance Init，用户点击的时候，就可以直接开始 js 业务")]),v._v(" "),l("li",[v._v("首页业务多，instance 初始化过多，开销太大。")]),v._v(" "),l("li",[v._v("单 Instance 多业务：Component 方法加载业务，无法使用 global")]),v._v(" "),l("li",[v._v("按需加载：公用部分在初始化时加载，业务部分在交互时才开始加载")])])]),v._v(" "),l("li",[v._v("延迟加载、渲染")])])]),v._v(" "),l("li",[v._v("跨端方案对比"),l("ul",[l("li",[v._v("RN 适用场景"),l("ul",[l("li",[v._v("超级 APP")]),v._v(" "),l("li",[v._v("体验平台级 APP")])])]),v._v(" "),l("li",[v._v("Hybrid：...")]),v._v(" "),l("li",[v._v("APK 插件：...")])])]),v._v(" "),l("li",[v._v("Summary"),l("ul",[l("li",[v._v("发版周期、开发成本和使用体验之间找到平衡")]),v._v(" "),l("li",[v._v("系统性工程：有机融入 APP")]),v._v(" "),l("li",[v._v("...")])])])]),v._v(" "),l("h3",{attrs:{id:"q-a"}},[v._v("Q&A")]),v._v(" "),l("ul",[l("li",[v._v("h5 和 RN 迭代的问题：两端齐头并进，各自开发")]),v._v(" "),l("li",[v._v("Native Module 问题上报：....")]),v._v(" "),l("li",[v._v("非结构化 ListView 优化：RN 做的话，很难解决，结构样式尽量简单一些")]),v._v(" "),l("li",[v._v("RN 版本升级应对：RN 的 持续交付。。。")])]),v._v(" "),l("hr"),v._v(" "),l("h2",{attrs:{id:"-weex-"}},[v._v("双十一 Weex 会场极致性能优化")]),v._v(" "),l("blockquote",[l("p",[v._v("分享者：阿里的冯成晓、周婷婷")]),v._v(" "),l("p",[v._v("终于面对面接触到 Weex 分享了。很久之前逢阿里面试官必问 Weex，想必他们烦极了。")]),v._v(" "),l("p",[v._v("和百度同学关于 RN 的分享两场一起听下来，真的收获多多。")]),v._v(" "),l("p",[v._v("印象非常好的一点是，分享过程中，反复提到 W3C 标准，提到希望补齐和 W3C 性能优化相关的 feature。这种思路应该是非常棒的。")])]),v._v(" "),l("ul",[l("li",[l("code",[v._v("f(HTML/CSS/JS) = Native UI")])]),v._v(" "),l("li",[v._v("DSL(HTML/CSS/JS) -> Virtual DOM -> Renderer -> UI")]),v._v(" "),l("li",[v._v("Transformer: DSL -> JS Bundle")]),v._v(" "),l("li",[v._v("JSFramework: DOM Tree"),l("ul",[l("li",[v._v("模板编译，数据绑定")])])]),v._v(" "),l("li",[v._v("Render：参照 Webkit"),l("ul",[l("li",[v._v("Build Tree")]),v._v(" "),l("li",[v._v("Compute Style")]),v._v(" "),l("li",[v._v("CSS Layout  (… Reflow, Relayout)")]),v._v(" "),l("li",[v._v("Create View")]),v._v(" "),l("li",[v._v("Update Frame")]),v._v(" "),l("li",[v._v("Set View Props (… RePaint)")]),v._v(" "),l("li",[v._v("Native View")])])])]),v._v(" "),l("h3",{attrs:{id:"-"}},[v._v("优化")]),v._v(" "),l("ul",[l("li",[v._v("下载 js： 预加载")]),v._v(" "),l("li",[v._v("执行 js：单 context 共享")]),v._v(" "),l("li",[v._v("解析 DOM： Node & Tree 解析结合")]),v._v(" "),l("li",[v._v("渲染 UI： List & 异步渲染（内存复用，只会渲染可见部分）")]),v._v(" "),l("li",[v._v("全局污染治理 + JSCore 内存管理")])]),v._v(" "),l("h3",{attrs:{id:"-"}},[v._v("性能优化指标")]),v._v(" "),l("ul",[l("li",[v._v("秒开率：加载时间+首屏时间 < 1s"),l("ul",[l("li",[v._v("加载时间：js bundle 加载时间")]),v._v(" "),l("li",[v._v("...")])])]),v._v(" "),l("li",[v._v("Weex 会场页面数：1700+，占比 99.6%")]),v._v(" "),l("li",[v._v("主会场 FPS：低端机 53， 高端机58")]),v._v(" "),l("li",[v._v("动画、视频、直播、全景图都是 Weex")])]),v._v(" "),l("h3",{attrs:{id:"-"}},[v._v("实战部分")]),v._v(" "),l("ul",[l("li",[v._v("列表过长，WebView 内存不好控制，容易 crash ")]),v._v(" "),l("li",[v._v("加载 js bundle：本地 IO 最快"),l("ul",[l("li",[v._v("APP 启动，预先下载 js")]),v._v(" "),l("li",[v._v("长连接通道 Push")]),v._v(" "),l("li",[v._v("全量/增量，被动/强制更新结合")])])]),v._v(" "),l("li",[v._v("预加载使用策略"),l("ul",[l("li",[v._v("根据业务特性斟酌")]),v._v(" "),l("li",[v._v("1700 个页面，由相同模板自由组合变成的")]),v._v(" "),l("li",[v._v("模块化，小粒度缓存")]),v._v(" "),l("li",[v._v("原来：1600 * 55 = 93 M")]),v._v(" "),l("li",[v._v("模块 + 配置：1700 "),l("em",[v._v(" 5 + 30 ")]),v._v(" 10 = 8.8 M")]),v._v(" "),l("li",[v._v("但是模块 +配置这样的秒开率低了 10%")]),v._v(" "),l("li",[v._v("业务个性化预加载，根据进入场景下载：类似 "),l("link",{attrs:{preload:""}})]),v._v(" "),l("li",[v._v("preload & prerender："),l("ul",[l("li",[v._v("dns-prefetch")]),v._v(" "),l("li",[v._v("preconnect（DNS + TCP connect）")]),v._v(" "),l("li",[v._v("prefetch")]),v._v(" "),l("li",[v._v("subresources（depreciated）")]),v._v(" "),l("li",[v._v("preload")]),v._v(" "),l("li",[v._v("prerender")])])])])]),v._v(" "),l("li",[v._v("js 执行"),l("ul",[l("li",[v._v("安卓下 V8 解析 js 耗时")]),v._v(" "),l("li",[v._v("减少 bundle size：去重，分离，通用组件内置")]),v._v(" "),l("li",[v._v("减少 VDOM 更新"),l("ul",[l("li",[v._v("shouldComponentUpdate")]),v._v(" "),l("li",[v._v("pureRenderMixin")])])])])]),v._v(" "),l("li",[v._v("动态数据并行预加载"),l("ul",[l("li",[v._v("点击时直接请求，然后存储在 storage 中（文蔺注：这块儿好像可以参考手机 QQ 家校 or 兴趣部落 React 的优化的文章）")]),v._v(" "),l("li",[v._v("storage LRU 策略")]),v._v(" "),l("li",[v._v("首屏数据请求参数不固定？。。。")]),v._v(" "),l("li",[v._v("jsbundle 走本地，效果如何？。。。")]),v._v(" "),l("li",[v._v("优化效果 80% 以上")])])]),v._v(" "),l("li",[v._v("首屏 UI 渲染"),l("ul",[l("li",[v._v("使用 list 代替 scroller")]),v._v(" "),l("li",[v._v("尽量减少布局嵌套")]),v._v(" "),l("li",[v._v("首屏以外的模板延迟初始化")]),v._v(" "),l("li",[v._v("新方案：requestIdleCallback")])])]),v._v(" "),l("li",[v._v("最佳实践"),l("ul",[l("li",[v._v("尽量 prefetch")]),v._v(" "),l("li",[v._v("use list")]),v._v(" "),l("li",[v._v("cell 细粒度拆分")]),v._v(" "),l("li",[v._v("减少首次加载内容")]),v._v(" "),l("li",[v._v("减少 js 大小")])])]),v._v(" "),l("li",[v._v("工具"),l("ul",[l("li",[v._v("Xcode simulator")]),v._v(" "),l("li",[v._v("Safari 10 Remote Inspector")])])]),v._v(" "),l("li",[v._v("性能指标优化流程（图）"),l("ul",[l("li",[v._v("发布基线")]),v._v(" "),l("li",[v._v("预发检测")]),v._v(" "),l("li",[v._v("线上监控")]),v._v(" "),l("li",[v._v("生成报表 <=== 业务达标基线")]),v._v(" "),l("li",[v._v("问题分析")]),v._v(" "),l("li",[v._v("开发修复")]),v._v(" "),l("li",[v._v("预发检测")]),v._v(" "),l("li",[v._v("。。。。")])])]),v._v(" "),l("li",[v._v("Week 下一阶段"),l("ul",[l("li",[v._v("W3C 性能优化 feature 补齐")]),v._v(" "),l("li",[v._v("性能 profile")]),v._v(" "),l("li",[v._v("完整开发模式")]),v._v(" "),l("li",[v._v("更丰富的交互体验")]),v._v(" "),l("li",[v._v("更丰富的 module 和 component")])])])])])},[],!1,null,null,null);_.default=component.exports}}]);